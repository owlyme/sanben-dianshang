// 全局app实例
import { debounce, isScrollUp, throttle} from '../../utils/commom';
import { Toast, boundingClientRect } from '../../utils/sysApis';
const App = getApp();

const goodListTypes = {
  0: 'special',
  1: 'rank',
  2: 'category'
}

Page({
  data: {
    stickyTop: 60, // sticky的吸顶距离
    stickyInitTop: 800, // 页面渲染时sticky的距离页顶的距离
    stickyInitBackground: 'none',
    interval: 3000,
    duration: 500,
    scrollViewHeight: 400,
    bannerList: [
      'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
      'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
      'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
    ],
    goodList: [
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,
        tags: ['hao', 'bucuo']
      },
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,
        active: '双十一',
        tags: ['hao', 'bucuo']
      },
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,

        tags: ['hao', 'bucuo']
      },
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,

        tags: ['hao', 'bucuo']
      },
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,

        tags: ['hao', 'bucuo']
      },
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,

        tags: ['hao', 'bucuo']
      },
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,

        tags: ['hao', 'bucuo']
      },
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,

        tags: ['hao', 'bucuo']
      },
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,

        tags: ['hao', 'bucuo']
      },
      {
        id: 0,
        pic: 'https://img.alicdn.com/tfscom/i4/654230132/O1CN011CqUjXBxyNTXTMy_!!654230132.jpg_300x300.jpg',
        name: '肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴肖优秀真皮细高跟过膝瘦腿弹力靴',
        price: '200.00',
        saledNumber: 200,

        tags: ['hao', 'bucuo']
      }
    ],
    goodListTypeListTab: [
      {
        name: '精选',
        sub: '为您推荐',
      },
      {
        name: '排行',
        sub: '人气商品',
      },
      {
        name: '分类',
        sub: '琳琅满目',
      }
    ],
    goodListType: '',
    categoryList: [
      { type: '1', name: '2222'},
      { type: '1', name: '23'},
      { type: '1', name: '24442'},
      { type: '1', name: '2266622'},
      { type: '1', name: '2444222'},
    ]
  },
  onLoad() {
    // Do some initialize when page load.
    this.getDom()
    this.throttleSwitchStickyStyle = throttle(this.switchStickyStyle, 200)
  },
  onReady() {
    // Do something when page ready.
   
  },
  async getDom() {
    let navHeight = App.globalData.navHeight
    let res = await boundingClientRect('.sticky-b');

    console.log(res)
    this.setData({
      stickyTop: navHeight,
      stickyInitTop: res.target_top
    });
  },
  switchStickyStyle(pageScrollTop) {
    let { stickyTop, stickyInitTop} = this.data
    this.setData({
      stickyInitBackground: pageScrollTop > stickyInitTop - stickyTop ? '#ffffff' : 'none'
    });
  },
  onShow() {
    // Do something when page show.
  },
  onHide() {
    // Do something when page hide.
  },
  onUnload() {
    // Do something when page close.
  },
  onPullDownRefresh() {
    // Do something when pull down.
  },
  onReachBottom() {
    // Do something when page reach bottom.
    console.log('Do something when page reach bottom.')
  },
  onShareAppMessage() {
    // return custom share data when user share.
  },
  onPageScroll (e) { 
    this.switchStickyStyle(e.scrollTop)
    this.throttleSwitchStickyStyle(e.scrollTop)
  },
  onTabItemTap() {
    // 当前是 tab 页时，点击 tab 时触发
  },
  onGoodListTypeChange(e) {
    let index = e.detail.index
    this.setData({
      goodListType: goodListTypes[index]
    })
    console.log(e)
  },
  onCategoryChange(e) {
    console.log(e)
  },

  viewGood(e){
    console.log('sign good', e);
  },

  customData: {}
});
